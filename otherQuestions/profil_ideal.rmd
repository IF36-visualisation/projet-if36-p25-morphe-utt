---
title: "Profil chimique moyen des vins excellents"
author: "Projet MorpheUTT"
output: html_document
---

# Analyse du graphique radar : Profils chimiques moyens des vins

Ce graphique radar compare les **profils chimiques moyens** de deux groupes de vins :
- **"Excellent"** (qualit√© ‚â• 8)
- **"Autre"** (qualit√© < 8)

Chaque axe repr√©sente une variable chimique normalis√©e entre 0 et 1 pour faciliter la comparaison.

## Variables analys√©es

- `alcohol` (teneur en alcool)
- `volatile.acidity` (acidit√© volatile)
- `citric.acid`
- `residual.sugar` (sucre r√©siduel)
- `chlorides`
- `free.sulfur.dioxide`
- `total.sulfur.dioxide`
- `density`
- `pH`
- `sulphates`

## üé® L√©gende

- **Vert** : Moyenne des vins "Excellent"
- **Gris** : Moyenne des vins "Autre"


## üß† Analyse du graphique radar

Ce graphique compare les **profils chimiques moyens** des vins selon leur note de qualit√©.

On observe plusieurs diff√©rences nettes entre les vins **excellents (note ‚â• 8)** et les autres :

| Variable                  | Observation                                                                     |
|---------------------------|---------------------------------------------------------------------------------|
| **alcohol**               | Significativement plus √©lev√© chez les vins "Excellent".                         |
| **volatile.acidity**      | Plus faible dans les vins "Excellent" ‚Äî moins de go√ªts d√©sagr√©ables.            |
| **citric.acid**           | L√©g√®rement plus √©lev√© chez les autres.                                          |
| **residual.sugar**        | Plus √©lev√© chez les "Autres", mais cela n‚Äôam√©liore pas forc√©ment la qualit√©.    |
| **chlorides**             | L√©g√®rement plus √©lev√© chez les "Excellent".                                     |
| **free.sulfur.dioxide**   | Plus √©lev√© chez les autres, sugg√©rant un exc√®s de soufre.                       |
| **total.sulfur.dioxide**  | Idem, potentiellement li√© √† une moins bonne conservation.                       |
| **density**               | Plus √©lev√© chez les "Excellent", ce qui peut refl√©ter une plus grande richesse. |
| **pH**                    | L√©g√®rement plus √©lev√© chez les vins "Excellent".                                |
| **sulphates**             | Plus √©lev√© chez les "Excellent", aidant √† la stabilit√© du vin.                  |

---

```{r setup, include=FALSE}
library(dplyr)
library(fmsb)
library(scales)

# Chargement des donn√©es
redwine <- read.csv("./data/red_wine.csv", sep = ";") %>%
  mutate(type = "Vin rouge")
whitewine <- read.csv("./data/white_wine.csv", sep = ";") %>%
  mutate(type = "Vin blanc")
wine_all <- bind_rows(redwine, whitewine)

# Regroupement : Excellent / Autre
wine_all <- wine_all %>%
  mutate(groupe = ifelse(quality >= 8, "Excellent", "Autre"))

# Variables chimiques
vars <- c("alcohol", "volatile.acidity", "citric.acid", "residual.sugar",
          "chlorides", "free.sulfur.dioxide", "total.sulfur.dioxide",
          "density", "pH", "sulphates")

# Moyennes par groupe
mean_data <- wine_all %>%
  group_by(groupe) %>%
  summarise(across(all_of(vars), mean, na.rm = TRUE), .groups = "drop")

# Calcul des min / max globaux pour chaque variable
global_min <- sapply(wine_all[vars], min, na.rm = TRUE)
global_max <- sapply(wine_all[vars], max, na.rm = TRUE)

# Normalisation des moyennes (par min/max global), puis en %
mean_pct <- as.data.frame(
  t(apply(mean_data[, vars], 1, function(x) {
    (x - global_min) / (global_max - global_min) * 100
  }))
)

rownames(mean_pct) <- mean_data$groupe

# Ajout des lignes max / min (obligatoire pour fmsb)
mean_pct <- rbind(rep(100, ncol(mean_pct)), rep(0, ncol(mean_pct)), mean_pct)

# Radar chart
colors_border <- c("#F4A261", "#264653")
colors_in <- c(alpha("#F4A261", 0.3), alpha("#264653", 0.3))

radarchart(
  mean_pct,
  axistype    = 1,
  pcol        = colors_border,
  pfcol       = colors_in,
  plwd        = 2,
  cglcol      = "grey", cglty = 1,
  axislabcol  = "grey20",
  seg         = 4,
  caxislabels = c("0%", "25%", "50%", "75%", "100%"),
  vlcex       = 0.8,
  title       = "Profils chimiques moyens (% de la plage globale)"
)

legend(
  "topright",
  legend   = rownames(mean_pct)[-(1:2)],
  bty      = "n",
  pch      = 20,
  col      = colors_border,
  text.col = "black",
  pt.cex   = 2
)
```


## üí° Interpr√©tation 1

On observe que la courbe des vins "Excellents" se distingue de celle des autres vins sur plusieurs axes cl√©s.
Par exemple, le profil moyen des vins excellents pr√©sente un taux d‚Äôalcool plus √©lev√© et une acidit√© volatile plus faible que celui des autres vins.
Inversement, les vins de qualit√© inf√©rieure montrent en moyenne des valeurs plus √©lev√©es en chlorures (teneur en sel) et des valeurs plus basses en alcool.
Globalement, les vins excellents tendent √† occuper une position plus favorable sur la plupart des param√®tres:
plus d‚Äôalcool, un peu plus d‚Äôacide citrique, moins d‚Äôacidit√© volatile et de chlorures, etc. √Ä l‚Äôinverse, les vins du groupe "autres" affichent des moyennes moins avantageuses sur ces crit√®res (par ex. acidit√© volatile plus forte, alcool moindre),
ce qui sugg√®re d√©j√† des diff√©rences de qualit√© en lien avec ces compos√©s.

En revanche, certaines variables ne semblent pas fortement discriminantes sur ce graphique des moyennes.
Par exemple, le sucre r√©siduel moyen est relativement bas dans les deux groupes (vins majoritairement secs),
avec peu d‚Äô√©cart notable entre vins excellents et autres. De m√™me, le pH moyen appara√Æt assez similaire pour les deux cat√©gories de vins, indiquant que l‚Äôacidit√© totale (fixe + volatile) moyenne ne diff√®re pas drastiquement entre les groupes.
Les sulfates pr√©sentent un √©cart moyen mod√©r√© entre groupes: les excellents vins ont des niveaux de sulfates comparables, voire l√©g√®rement inf√©rieurs,
√† ceux des autres vins en moyenne. Ces premi√®res observations sugg√®rent donc que seuls certains param√®tres chimiques distinguent nettement les vins de haute qualit√©.
Les variables comme l‚Äôalcool, l‚Äôacidit√© volatile ou les chlorures montrent des √©carts moyens significatifs entre groupes, tandis que d‚Äôautres (pH, sucre r√©siduel, sulfates‚Ä¶) sont plus proches, du moins en valeur moyenne.
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(fmsb)
library(scales)

# Chargement des donn√©es
redwine <- read.csv("./data/red_wine.csv", sep = ";") %>%
  mutate(type = "Vin rouge")
whitewine <- read.csv("./data/white_wine.csv", sep = ";") %>%
  mutate(type = "Vin blanc")
wine_all <- bind_rows(redwine, whitewine)

# Cr√©ation de la variable binaire de qualit√©
wine_all <- wine_all %>%
  mutate(groupe = ifelse(quality >= 8, "Excellent", "Autre"))

# Variables √† visualiser
vars <- c("alcohol", "volatile.acidity", "citric.acid", "residual.sugar",
          "chlorides", "free.sulfur.dioxide", "total.sulfur.dioxide",
          "density", "pH", "sulphates")

# Moyennes par groupe
mean_data <- wine_all %>%
  group_by(groupe) %>%
  summarise(across(all_of(vars), mean, na.rm = TRUE))

# Pr√©paration du format fmsb
rownames(mean_data) <- mean_data$groupe
mean_data$groupe <- NULL

# Normalisation entre 0 et 1
mean_scaled <- as.data.frame(lapply(mean_data, rescale))
mean_scaled <- rbind(rep(1, ncol(mean_scaled)), rep(0, ncol(mean_scaled)), mean_scaled)

# Couleurs
colors_border <- c("#F4A261", "#264653")
colors_in <- c(alpha("#F4A261", 0.3), alpha("#264653", 0.3))

radarchart(
  mean_scaled,
  axistype    = 1,
  pcol        = colors_border,
  pfcol       = colors_in,
  plwd        = 2,
  cglcol      = "grey", cglty = 1,
  axislabcol  = "grey20",
  seg         = 1,                    # une seule graduation
  caxislabels = c("0", "1"),          # on affiche juste 0 (centre) et 1 (bord)
  vlcex       = 0.8,
  title       = "Comparaison des profils chimiques (1 = max, 0 = min)"
)

legend(
  "topright",
  legend   = rownames(mean_scaled),
  bty      = "n",
  pch      = 20,
  col      = colors_border,
  text.col = "black",
  pt.cex   = 2
)
```
## üí° Interpr√©tation 2

Ce second visuel applique une normalisation min‚Äìmax stricte sur chaque variable, de sorte que pour chaque axe,
la valeur 0 correspond au minimum global et 1 au maximum global enregistr√© dans l‚Äôensemble de donn√©es.
Cette repr√©sentation met en √©vidence les √©carts extr√™mes entre les deux groupes, en montrant dans quelle mesure chaque groupe s‚Äôapproche des valeurs minimales ou maximales possibles par variable.
On constate que les diff√©rences d√©j√† entrevues dans le graphique pr√©c√©dent apparaissent ici de mani√®re encore plus prononc√©e.
Par exemple, sur l‚Äôaxe alcool, la courbe des vins excellents atteint 1.0 (le maximum), tandis que celle des autres vins reste nettement en de√ß√†, a 0.
‚Äì signe que les vins de haute qualit√© tendent √† titrer parmi les degr√©s d‚Äôalcool les plus √©lev√©s du panel.

√Ä l‚Äôoppos√©, pour l‚Äôacidit√© volatile, la courbe du groupe "autres" monte vers 1.0, indiquant que les vins de moindre qualit√© approchent le maximum d‚Äôacidit√© volatile observ√©, alors que les excellents restent pr√®s de 0 (proche du minimum de VA).

Cette visualisation extr√™me r√©v√®le ainsi quelles variables ont les √©carts relatifs les plus marqu√©s entre groupes.
On remarque que les vins "Excellents" atteignent ou fr√¥lent l‚Äôextr√©mit√© favorable sur plusieurs axes: outre l‚Äôalcool √©lev√©, ils pr√©sentent parmi les teneurs les plus basses en chlorures et en densit√©
(une densit√© plus faible d√©coule d‚Äôun alcool plus √©lev√© et d‚Äôun extrait sec mod√©r√©, caract√©ristiques des vins mieux not√©s).
Ils affichent aussi des valeurs tr√®s √©lev√©es en SO‚ÇÇ libre et total. n revanche, le groupe des autres vins se distingue par certains p√¥les extr√™mes d√©favorables:
en plus d‚Äôune acidit√© volatile tr√®s forte, ils atteignent par exemple le maximum en chlorures (ils contiennent pour certains autant de sel que le vin le plus sal√© analys√©)
et affichent une des valeurs les plus √©lev√©es en sulfates.

## Conclusion

Les param√®tres les plus discriminants pour reconna√Ætre un vin excellent sont l‚Äôalcool √©lev√©, l‚Äôacidit√© volatile basse, un faible taux de chlorures,
et dans une moindre mesure un bon √©quilibre en sulfates, une acidit√© fixe un peu plus √©lev√©e (pH l√©g√®rement plus bas), ainsi qu‚Äôune gestion appropri√©e du SO‚ÇÇ.
Ces facteurs concordent avec ce qui est rapport√© dans la litt√©rature ≈ìnologique et les analyses de corr√©lation sur des jeux de donn√©es de vins:
la qualit√© du vin est fortement corr√©l√©e positivement √† l‚Äôalcool et n√©gativement √† l‚Äôacidit√© volatile,
elle est √©galement li√©e significativement (quoique plus mod√©r√©ment) √† des param√®tres comme les sulfates, l‚Äôacide citrique, les chlorures ou le SO‚ÇÇ.
√Ä l‚Äôinverse, des variables comme le sucre r√©siduel ou l‚Äôacidit√© fixe (indirectement refl√©t√©e par le pH) montrent peu d‚Äôinfluence directe sur la qualit√© per√ßuedans ce contexte